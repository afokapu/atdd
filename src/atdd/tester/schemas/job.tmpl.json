{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Job Test Harness Template",
  "description": "Template for background job/cron tests",
  "language": "python",
  "framework": "pytest",
  "category": "integration",
  "template": "\n# URN: {urn}\nimport pytest\nimport json\nimport time\n{imports}\n\ndef test_{test_name}():\n    # Given\n    {given_setup}\n    \n    # When\n    start_time = time.time()\n    result = {job_invocation}\n    duration = time.time() - start_time\n    \n    # Then\n    {then_assertions}\n    \n    print(json.dumps({{\n        'urn': '{urn}',\n        'status': 'PASS',\n        'details': {{\n            'job': '{job_name}',\n            'duration_seconds': duration,\n            'result': str(result)\n        }}\n    }}))\n",
  "variables": [
    "urn",
    "test_name",
    "imports",
    "given_setup",
    "job_name",
    "job_invocation",
    "then_assertions",
    "wagon",
    "feature",
    "wmbt_id",
    "nnn",
    "slug",
    "layer",
    "train_id"
  ],
  "header_template": {
    "acceptance": "// URN: test:{wagon}:{feature}:{wmbt_id}-JOB-{nnn}-{slug}\n// Acceptance: acc:{wagon}:{wmbt_id}-JOB-{nnn}[-{slug}]\n// WMBT: wmbt:{wagon}:{wmbt_id}\n// Phase: RED\n// Layer: {layer}\n",
    "journey": "// URN: test:train:{train_id}:JOB-{nnn}-{slug}\n// Train: train:{train_id}\n// Phase: RED\n// Layer: assembly\n"
  }
}
